{"ast":null,"code":"var _jsxFileName = \"/Users/trabajo/Desktop/ELRINCON/react-rincon/src/modules/editProfile.js\";\nimport React from 'react';\nimport '../../node_modules/bootstrap/dist/css/bootstrap.min.css';\nimport '../../node_modules/bootstrap/dist/js/bootstrap.bundle.min';\nimport { Redirect } from \"react-router-dom\";\nimport ProfessionalService from '../services/professional.service';\nimport ProfileController from '../controllers/profileController';\nimport Swal from 'sweetalert2';\nimport $ from 'jquery';\nimport Nav from '../components/nav';\n\nclass profileComponent extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      redirect: null,\n      departments: [],\n      roles: [],\n      tutors: [],\n      id: null,\n      name: null,\n      departmentId: null,\n      roleId: null,\n      email: sessionStorage.getItem(\"userEmail\"),\n      tutorId: null,\n      comment: \"\",\n      image: null,\n      imageId: null\n    };\n  }\n\n  componentDidMount() {\n    this.isUserRegistered(); //Professional info\n\n    ProfileController.queryProfessionals().then(res => {\n      this.setState(res);\n      console.log(res.image.data);\n    }); //Dropdowns\n\n    ProfileController.loadDepartments().then(each => this.setState({\n      departments: each\n    }));\n    ProfileController.loadRoles().then(each => this.setState({\n      roles: each\n    }));\n    ProfileController.loadTutors().then(each => this.setState({\n      tutors: each\n    }));\n  }\n\n  isUserRegistered() {\n    if (sessionStorage.getItem('isUserRegistered') == 'false') {\n      this.setState({\n        redirect: '/crear-perfil'\n      });\n    }\n  }\n\n  render() {\n    if (this.state.redirect) {\n      return /*#__PURE__*/React.createElement(Redirect, {\n        to: this.state.redirect,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 54,\n          columnNumber: 20\n        }\n      });\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Nav, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 18\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"container p-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"script\", {\n      src: \"https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-lg-9\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"card\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"card-body\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"form-group \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      value: this.state.name,\n      onChange: value => this.setState({\n        name: value.target.value\n      }),\n      class: \"form-control\",\n      name: \"nombre\",\n      placeholder: \"Nombre\",\n      autofocus: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 37\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-lg-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 41\n      }\n    }, /*#__PURE__*/React.createElement(\"select\", {\n      class: \"form-control\",\n      value: this.state.departmentId,\n      onChange: value => this.setState({\n        departmentId: value.target.value\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 45\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      selected: true,\n      disabled: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 49\n      }\n    }, \"Departamento\"), this.state.departments))), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-lg-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 41\n      }\n    }, /*#__PURE__*/React.createElement(\"select\", {\n      class: \"form-control\",\n      value: this.state.roleId,\n      onChange: value => this.setState({\n        roleId: value.target.value\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 45\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      selected: true,\n      disabled: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 49\n      }\n    }, \"Rol\"), this.state.roles))), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-lg-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 41\n      }\n    }, /*#__PURE__*/React.createElement(\"select\", {\n      class: \"form-control\",\n      value: this.state.tutorId,\n      onChange: value => this.setState({\n        tutorId: value.target.value\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 45\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      selected: true,\n      disabled: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 49\n      }\n    }, \"Tutor\\xEDa\"), this.state.tutors)))), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"textarea\", {\n      class: \"form-control\",\n      value: this.state.comment,\n      onChange: value => this.setState({\n        comment: value.target.value\n      }),\n      placeholder: \"Introduzca si lo desea alg\\xFAn comentario: Me gusta J\",\n      rows: \"3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 37\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"submit\",\n      class: \"btn btn-success\",\n      onClick: () => this.updateProfessional(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 37\n      }\n    }, \"Actualizar\"))))), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-lg-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"card\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"card-body text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      class: \"md-form\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"file-field\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"md-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 41\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: require(\"../images/profile-picture.jpg\"),\n      ref: profilePicture => this.myProfilePicture = profilePicture,\n      id: \"blah\",\n      class: \"rounded-circle z-depth-1-half avatar-pic img-fluid img-thumbnail\",\n      alt: \"avatar\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 45\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        marginTop: \"10px\"\n      },\n      class: \"d-flex\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 45\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"btn btn-mdb-color btn-rounded float-left custom-file\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 49\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      style: {\n        width: \"100%\"\n      },\n      ref: myElement => this.myFileElement = myElement,\n      type: \"file\",\n      id: \"imgInput\",\n      className: \"custom-file-input btn btn-primary\",\n      onChange: value => {\n        this.readURL(value.target);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 53\n      }\n    }), /*#__PURE__*/React.createElement(\"label\", {\n      class: \"custom-file-label\",\n      for: \"customFile\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 53\n      }\n    }, \"Perfil\"))))))))))));\n  }\n\n  readURL(input) {\n    if (input.files && input.files[0]) {\n      const myValue = input.files[0];\n\n      if (myValue.type.includes(\"image\")) {\n        const reader = new FileReader();\n        let miImagen = {\n          name: myValue.name,\n          type: myValue.type\n        };\n        reader.readAsDataURL(myValue);\n\n        reader.onload = async event => {\n          miImagen.data = await event.target.result;\n          this.state.image = miImagen;\n          $('#blah').attr('src', this.state.image.data);\n        };\n\n        reader.onerror = err => {\n          console.error('Error en lectura de imagen --> ' + err);\n        };\n      } else {\n        Swal.fire({\n          position: 'top',\n          icon: 'error',\n          title: 'Sólo archivos de tipo imagen!',\n          showConfirmButton: false,\n          timer: 2000\n        });\n      }\n    }\n  }\n\n  async cargarImagenDeBBDD(imagenDeBBDD) {\n    let buffer = await ProfileController.cargarImagenDeBBDD(imagenDeBBDD); //console.log(buffer);\n\n    if (buffer) {\n      //Setear imagen en html\n      $('#blah').attr('src', buffer); //actualizar el state\n\n      this.setState({\n        image: buffer\n      });\n    }\n  }\n\n  validateFields() {\n    let emptyFields = \"\";\n    let count = 0;\n    const nombre = this.state.name;\n\n    if (nombre.replace(/\\s/g, \"\").length == 0) {\n      emptyFields += \" Nombre \";\n      count++;\n    }\n\n    if (this.state.departmentId == null) {\n      emptyFields += \" Departamento \";\n      count++;\n    }\n\n    if (this.state.roleId == null) {\n      emptyFields += \" Rol \";\n      count++;\n    } //If there are errors\n\n\n    if (count > 0) {\n      Swal.fire({\n        position: 'center',\n        icon: 'error',\n        title: (count == 1 ? \"Falta el campo\" : \"Faltan los campos: \") + emptyFields,\n        showConfirmButton: false,\n        timer: 2000\n      });\n      return false;\n    } else {\n      return true;\n    }\n  }\n\n  updateProfessional() {\n    if (this.validateFields() == false) {\n      return;\n    } // parametros de datos post\n\n\n    const datapost = {\n      id: this.state.id,\n      name: this.state.name,\n      departmentId: this.state.departmentId,\n      roleId: this.state.roleId,\n      email: this.state.email,\n      tutorId: this.state.tutorId,\n      comment: this.state.comment,\n      image: this.state.image,\n      imageId: this.state.imageId\n    };\n    ProfessionalService.update(datapost).then(res => {\n      if (res.data.success) {\n        Swal.fire({\n          position: 'top',\n          icon: 'success',\n          title: 'Profesional actualizado correctamente!',\n          showConfirmButton: false,\n          timer: 2000\n        });\n      } else {\n        console.error(\"Error\");\n      }\n    }).catch(error => {\n      console.error(\"Error 34 \" + error);\n    });\n  }\n\n}\n\nexport default profileComponent;","map":{"version":3,"sources":["/Users/trabajo/Desktop/ELRINCON/react-rincon/src/modules/editProfile.js"],"names":["React","Redirect","ProfessionalService","ProfileController","Swal","$","Nav","profileComponent","Component","constructor","props","state","redirect","departments","roles","tutors","id","name","departmentId","roleId","email","sessionStorage","getItem","tutorId","comment","image","imageId","componentDidMount","isUserRegistered","queryProfessionals","then","res","setState","console","log","data","loadDepartments","each","loadRoles","loadTutors","render","value","target","updateProfessional","require","profilePicture","myProfilePicture","marginTop","width","myElement","myFileElement","readURL","input","files","myValue","type","includes","reader","FileReader","miImagen","readAsDataURL","onload","event","result","attr","onerror","err","error","fire","position","icon","title","showConfirmButton","timer","cargarImagenDeBBDD","imagenDeBBDD","buffer","validateFields","emptyFields","count","nombre","replace","length","datapost","update","success","catch"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAO,yDAAP;AACA,OAAO,2DAAP;AACA,SAASC,QAAT,QAAyB,kBAAzB;AACA,OAAOC,mBAAP,MAAgC,kCAAhC;AACA,OAAOC,iBAAP,MAA8B,kCAA9B;AACA,OAAOC,IAAP,MAAiB,aAAjB;AACA,OAAOC,CAAP,MAAc,QAAd;AACA,OAAOC,GAAP,MAAgB,mBAAhB;;AAGA,MAAMC,gBAAN,SAA+BP,KAAK,CAACQ,SAArC,CAA+C;AAE3CC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACf,UAAMA,KAAN;AACA,SAAKC,KAAL,GAAa;AACTC,MAAAA,QAAQ,EAAE,IADD;AAETC,MAAAA,WAAW,EAAE,EAFJ;AAGTC,MAAAA,KAAK,EAAE,EAHE;AAITC,MAAAA,MAAM,EAAE,EAJC;AAKTC,MAAAA,EAAE,EAAE,IALK;AAMTC,MAAAA,IAAI,EAAE,IANG;AAOTC,MAAAA,YAAY,EAAE,IAPL;AAQTC,MAAAA,MAAM,EAAE,IARC;AASTC,MAAAA,KAAK,EAAEC,cAAc,CAACC,OAAf,CAAuB,WAAvB,CATE;AAUTC,MAAAA,OAAO,EAAE,IAVA;AAWTC,MAAAA,OAAO,EAAE,EAXA;AAYTC,MAAAA,KAAK,EAAE,IAZE;AAaTC,MAAAA,OAAO,EAAE;AAbA,KAAb;AAeH;;AAEDC,EAAAA,iBAAiB,GAAG;AAChB,SAAKC,gBAAL,GADgB,CAEhB;;AACAzB,IAAAA,iBAAiB,CAAC0B,kBAAlB,GAAuCC,IAAvC,CAA6CC,GAAD,IAAQ;AAChD,WAAKC,QAAL,CAAcD,GAAd;AACAE,MAAAA,OAAO,CAACC,GAAR,CAAYH,GAAG,CAACN,KAAJ,CAAUU,IAAtB;AACH,KAHD,EAHgB,CAOhB;;AACAhC,IAAAA,iBAAiB,CAACiC,eAAlB,GAAoCN,IAApC,CAAyCO,IAAI,IAAI,KAAKL,QAAL,CAAc;AAACnB,MAAAA,WAAW,EAAEwB;AAAd,KAAd,CAAjD;AACAlC,IAAAA,iBAAiB,CAACmC,SAAlB,GAA8BR,IAA9B,CAAmCO,IAAI,IAAI,KAAKL,QAAL,CAAc;AAAClB,MAAAA,KAAK,EAAEuB;AAAR,KAAd,CAA3C;AACAlC,IAAAA,iBAAiB,CAACoC,UAAlB,GAA+BT,IAA/B,CAAoCO,IAAI,IAAI,KAAKL,QAAL,CAAc;AAACjB,MAAAA,MAAM,EAAEsB;AAAT,KAAd,CAA5C;AACH;;AAEDT,EAAAA,gBAAgB,GAAG;AACf,QAAIP,cAAc,CAACC,OAAf,CAAuB,kBAAvB,KAA8C,OAAlD,EAA2D;AACvD,WAAKU,QAAL,CAAc;AAAEpB,QAAAA,QAAQ,EAAE;AAAZ,OAAd;AACH;AACJ;;AAED4B,EAAAA,MAAM,GAAG;AACL,QAAI,KAAK7B,KAAL,CAAWC,QAAf,EAAyB;AACrB,0BAAO,oBAAC,QAAD;AAAU,QAAA,EAAE,EAAE,KAAKD,KAAL,CAAWC,QAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAP;AACH;;AACD,wBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAK,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAL,eACA;AAAK,MAAA,KAAK,EAAC,eAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAQ,MAAA,GAAG,EAAC,kEAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,eAEI;AAAK,MAAA,KAAK,EAAC,KAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,KAAK,EAAC,UAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,KAAK,EAAC,MAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,KAAK,EAAC,WAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,KAAK,EAAC,aAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAO,MAAA,IAAI,EAAC,MAAZ;AACI,MAAA,KAAK,EAAE,KAAKD,KAAL,CAAWM,IADtB;AAEI,MAAA,QAAQ,EAAGwB,KAAD,IAAW,KAAKT,QAAL,CAAc;AAAEf,QAAAA,IAAI,EAAEwB,KAAK,CAACC,MAAN,CAAaD;AAArB,OAAd,CAFzB;AAGI,MAAA,KAAK,EAAC,cAHV;AAGyB,MAAA,IAAI,EAAC,QAH9B;AAGuC,MAAA,WAAW,EAAC,QAHnD;AAG4D,MAAA,SAAS,MAHrE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,CADJ,eASI;AAAK,MAAA,KAAK,EAAC,KAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,KAAK,EAAC,UAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,KAAK,EAAC,YAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAQ,MAAA,KAAK,EAAC,cAAd;AACI,MAAA,KAAK,EAAE,KAAK9B,KAAL,CAAWO,YADtB;AAEI,MAAA,QAAQ,EAAGuB,KAAD,IAAW,KAAKT,QAAL,CAAc;AAAEd,QAAAA,YAAY,EAAEuB,KAAK,CAACC,MAAN,CAAaD;AAA7B,OAAd,CAFzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAGI;AAAQ,MAAA,QAAQ,MAAhB;AAAiB,MAAA,QAAQ,MAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAHJ,EAIK,KAAK9B,KAAL,CAAWE,WAJhB,CADJ,CADJ,CADJ,eAaI;AAAK,MAAA,KAAK,EAAC,UAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,KAAK,EAAC,YAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAQ,MAAA,KAAK,EAAC,cAAd;AACI,MAAA,KAAK,EAAE,KAAKF,KAAL,CAAWQ,MADtB;AAEI,MAAA,QAAQ,EAAGsB,KAAD,IAAW,KAAKT,QAAL,CAAc;AAAEb,QAAAA,MAAM,EAAEsB,KAAK,CAACC,MAAN,CAAaD;AAAvB,OAAd,CAFzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAGI;AAAQ,MAAA,QAAQ,MAAhB;AAAiB,MAAA,QAAQ,MAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAHJ,EAIK,KAAK9B,KAAL,CAAWG,KAJhB,CADJ,CADJ,CAbJ,eAwBI;AAAK,MAAA,KAAK,EAAC,UAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,KAAK,EAAC,YAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAQ,MAAA,KAAK,EAAC,cAAd;AACI,MAAA,KAAK,EAAE,KAAKH,KAAL,CAAWY,OADtB;AAEI,MAAA,QAAQ,EAAGkB,KAAD,IAAW,KAAKT,QAAL,CAAc;AAAET,QAAAA,OAAO,EAAEkB,KAAK,CAACC,MAAN,CAAaD;AAAxB,OAAd,CAFzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAGI;AAAQ,MAAA,QAAQ,MAAhB;AAAiB,MAAA,QAAQ,MAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAHJ,EAIK,KAAK9B,KAAL,CAAWI,MAJhB,CADJ,CADJ,CAxBJ,CATJ,eA8CI;AAAK,MAAA,KAAK,EAAC,YAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAU,MAAA,KAAK,EAAC,cAAhB;AACI,MAAA,KAAK,EAAE,KAAKJ,KAAL,CAAWa,OADtB;AAEI,MAAA,QAAQ,EAAGiB,KAAD,IAAW,KAAKT,QAAL,CAAc;AAAER,QAAAA,OAAO,EAAEiB,KAAK,CAACC,MAAN,CAAaD;AAAxB,OAAd,CAFzB;AAGI,MAAA,WAAW,EAAC,wDAHhB;AAII,MAAA,IAAI,EAAC,GAJT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,CA9CJ,eAsDI;AAAK,MAAA,KAAK,EAAC,YAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAQ,MAAA,IAAI,EAAC,QAAb;AAAsB,MAAA,KAAK,EAAC,iBAA5B;AAA8C,MAAA,OAAO,EAAE,MAAM,KAAKE,kBAAL,EAA7D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADJ,CAtDJ,CADJ,CADJ,CADJ,eAgEI;AAAK,MAAA,KAAK,EAAC,UAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,KAAK,EAAC,MAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,KAAK,EAAC,uBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAM,MAAA,KAAK,EAAC,SAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,KAAK,EAAC,YAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,KAAK,EAAC,MAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,GAAG,EAAEC,OAAO,CAAC,+BAAD,CAAjB;AACI,MAAA,GAAG,EAAEC,cAAc,IAAI,KAAKC,gBAAL,GAAwBD,cADnD;AAEI,MAAA,EAAE,EAAC,MAFP;AAGI,MAAA,KAAK,EAAC,kEAHV;AAG6E,MAAA,GAAG,EAAC,QAHjF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,eAOI;AAAK,MAAA,KAAK,EAAE;AAAEE,QAAAA,SAAS,EAAE;AAAb,OAAZ;AAAmC,MAAA,KAAK,EAAC,QAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,KAAK,EAAC,sDAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAO,MAAA,KAAK,EAAE;AAAEC,QAAAA,KAAK,EAAE;AAAT,OAAd;AAAiC,MAAA,GAAG,EAAGC,SAAD,IAAe,KAAKC,aAAL,GAAqBD,SAA1E;AACI,MAAA,IAAI,EAAC,MADT;AAEI,MAAA,EAAE,EAAC,UAFP;AAGI,MAAA,SAAS,EAAC,mCAHd;AAII,MAAA,QAAQ,EAAGR,KAAD,IAAW;AAAE,aAAKU,OAAL,CAAaV,KAAK,CAACC,MAAnB;AAA4B,OAJvD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,eAOI;AAAO,MAAA,KAAK,EAAC,mBAAb;AAAiC,MAAA,GAAG,EAAC,YAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAPJ,CADJ,CAPJ,CADJ,CADJ,CADJ,CADJ,CADJ,CAhEJ,CAFJ,CADA,CADJ;AAsGH;;AAGDS,EAAAA,OAAO,CAACC,KAAD,EAAQ;AACX,QAAIA,KAAK,CAACC,KAAN,IAAeD,KAAK,CAACC,KAAN,CAAY,CAAZ,CAAnB,EAAmC;AAC/B,YAAMC,OAAO,GAAGF,KAAK,CAACC,KAAN,CAAY,CAAZ,CAAhB;;AAEA,UAAIC,OAAO,CAACC,IAAR,CAAaC,QAAb,CAAsB,OAAtB,CAAJ,EAAoC;AAChC,cAAMC,MAAM,GAAG,IAAIC,UAAJ,EAAf;AACA,YAAIC,QAAQ,GAAG;AACX1C,UAAAA,IAAI,EAAEqC,OAAO,CAACrC,IADH;AAEXsC,UAAAA,IAAI,EAAED,OAAO,CAACC;AAFH,SAAf;AAKAE,QAAAA,MAAM,CAACG,aAAP,CAAqBN,OAArB;;AACAG,QAAAA,MAAM,CAACI,MAAP,GAAgB,MAAOC,KAAP,IAAiB;AAC7BH,UAAAA,QAAQ,CAACxB,IAAT,GAAgB,MAAM2B,KAAK,CAACpB,MAAN,CAAaqB,MAAnC;AACA,eAAKpD,KAAL,CAAWc,KAAX,GAAmBkC,QAAnB;AACAtD,UAAAA,CAAC,CAAC,OAAD,CAAD,CAAW2D,IAAX,CAAgB,KAAhB,EAAuB,KAAKrD,KAAL,CAAWc,KAAX,CAAiBU,IAAxC;AACH,SAJD;;AAKAsB,QAAAA,MAAM,CAACQ,OAAP,GAAkBC,GAAD,IAAS;AACtBjC,UAAAA,OAAO,CAACkC,KAAR,CAAc,oCAAkCD,GAAhD;AACH,SAFD;AAGH,OAhBD,MAgBO;AACH9D,QAAAA,IAAI,CAACgE,IAAL,CAAU;AACNC,UAAAA,QAAQ,EAAE,KADJ;AAENC,UAAAA,IAAI,EAAE,OAFA;AAGNC,UAAAA,KAAK,EAAE,+BAHD;AAINC,UAAAA,iBAAiB,EAAE,KAJb;AAKNC,UAAAA,KAAK,EAAE;AALD,SAAV;AAOH;AACJ;AACJ;;AAED,QAAMC,kBAAN,CAAyBC,YAAzB,EAAuC;AACnC,QAAIC,MAAM,GAAG,MAAMzE,iBAAiB,CAACuE,kBAAlB,CAAqCC,YAArC,CAAnB,CADmC,CAEnC;;AACA,QAAIC,MAAJ,EAAY;AACR;AACAvE,MAAAA,CAAC,CAAC,OAAD,CAAD,CAAW2D,IAAX,CAAgB,KAAhB,EAAuBY,MAAvB,EAFQ,CAGR;;AACA,WAAK5C,QAAL,CAAc;AAAEP,QAAAA,KAAK,EAAEmD;AAAT,OAAd;AACH;AACJ;;AAEDC,EAAAA,cAAc,GAAG;AACb,QAAIC,WAAW,GAAG,EAAlB;AACA,QAAIC,KAAK,GAAG,CAAZ;AACA,UAAMC,MAAM,GAAG,KAAKrE,KAAL,CAAWM,IAA1B;;AAEA,QAAI+D,MAAM,CAACC,OAAP,CAAe,KAAf,EAAsB,EAAtB,EAA0BC,MAA1B,IAAoC,CAAxC,EAA2C;AACvCJ,MAAAA,WAAW,IAAI,UAAf;AACAC,MAAAA,KAAK;AACR;;AACD,QAAI,KAAKpE,KAAL,CAAWO,YAAX,IAA2B,IAA/B,EAAqC;AACjC4D,MAAAA,WAAW,IAAI,gBAAf;AACAC,MAAAA,KAAK;AACR;;AACD,QAAI,KAAKpE,KAAL,CAAWQ,MAAX,IAAqB,IAAzB,EAA+B;AAC3B2D,MAAAA,WAAW,IAAI,OAAf;AACAC,MAAAA,KAAK;AACR,KAhBY,CAkBb;;;AACA,QAAIA,KAAK,GAAG,CAAZ,EAAe;AACX3E,MAAAA,IAAI,CAACgE,IAAL,CAAU;AACNC,QAAAA,QAAQ,EAAE,QADJ;AAENC,QAAAA,IAAI,EAAE,OAFA;AAGNC,QAAAA,KAAK,EAAE,CAACQ,KAAK,IAAI,CAAT,GAAa,gBAAb,GAAgC,qBAAjC,IAA0DD,WAH3D;AAINN,QAAAA,iBAAiB,EAAE,KAJb;AAKNC,QAAAA,KAAK,EAAE;AALD,OAAV;AAOA,aAAO,KAAP;AACH,KATD,MASO;AACH,aAAO,IAAP;AACH;AAEJ;;AAED9B,EAAAA,kBAAkB,GAAG;AACjB,QAAI,KAAKkC,cAAL,MAAyB,KAA7B,EAAoC;AAChC;AACH,KAHgB,CAKjB;;;AACA,UAAMM,QAAQ,GAAG;AACbnE,MAAAA,EAAE,EAAE,KAAKL,KAAL,CAAWK,EADF;AAEbC,MAAAA,IAAI,EAAE,KAAKN,KAAL,CAAWM,IAFJ;AAGbC,MAAAA,YAAY,EAAE,KAAKP,KAAL,CAAWO,YAHZ;AAIbC,MAAAA,MAAM,EAAE,KAAKR,KAAL,CAAWQ,MAJN;AAKbC,MAAAA,KAAK,EAAE,KAAKT,KAAL,CAAWS,KALL;AAMbG,MAAAA,OAAO,EAAE,KAAKZ,KAAL,CAAWY,OANP;AAObC,MAAAA,OAAO,EAAE,KAAKb,KAAL,CAAWa,OAPP;AAQbC,MAAAA,KAAK,EAAE,KAAKd,KAAL,CAAWc,KARL;AASbC,MAAAA,OAAO,EAAE,KAAKf,KAAL,CAAWe;AATP,KAAjB;AAYAxB,IAAAA,mBAAmB,CAACkF,MAApB,CAA2BD,QAA3B,EACKrD,IADL,CACUC,GAAG,IAAI;AACT,UAAIA,GAAG,CAACI,IAAJ,CAASkD,OAAb,EAAsB;AAClBjF,QAAAA,IAAI,CAACgE,IAAL,CAAU;AACNC,UAAAA,QAAQ,EAAE,KADJ;AAENC,UAAAA,IAAI,EAAE,SAFA;AAGNC,UAAAA,KAAK,EAAE,wCAHD;AAINC,UAAAA,iBAAiB,EAAE,KAJb;AAKNC,UAAAA,KAAK,EAAE;AALD,SAAV;AAOH,OARD,MASK;AACDxC,QAAAA,OAAO,CAACkC,KAAR,CAAc,OAAd;AACH;AACJ,KAdL,EAcOmB,KAdP,CAcanB,KAAK,IAAI;AACdlC,MAAAA,OAAO,CAACkC,KAAR,CAAc,cAAcA,KAA5B;AACH,KAhBL;AAiBH;;AArQ0C;;AA0Q/C,eAAe5D,gBAAf","sourcesContent":["import React from 'react';\nimport '../../node_modules/bootstrap/dist/css/bootstrap.min.css';\nimport '../../node_modules/bootstrap/dist/js/bootstrap.bundle.min';\nimport { Redirect } from \"react-router-dom\";\nimport ProfessionalService from '../services/professional.service';\nimport ProfileController from '../controllers/profileController';\nimport Swal from 'sweetalert2';\nimport $ from 'jquery';\nimport Nav from '../components/nav';\n\n\nclass profileComponent extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            redirect: null,\n            departments: [],\n            roles: [],\n            tutors: [],\n            id: null,\n            name: null,\n            departmentId: null,\n            roleId: null,\n            email: sessionStorage.getItem(\"userEmail\"),\n            tutorId: null,\n            comment: \"\",\n            image: null,\n            imageId: null\n        };\n    }\n\n    componentDidMount() {\n        this.isUserRegistered();\n        //Professional info\n        ProfileController.queryProfessionals().then((res)=> {\n            this.setState(res);\n            console.log(res.image.data);\n        });\n        //Dropdowns\n        ProfileController.loadDepartments().then(each => this.setState({departments: each}));\n        ProfileController.loadRoles().then(each => this.setState({roles: each}));\n        ProfileController.loadTutors().then(each => this.setState({tutors: each}));\n    }   \n    \n    isUserRegistered() {\n        if (sessionStorage.getItem('isUserRegistered') == 'false') {\n            this.setState({ redirect: '/crear-perfil' });\n        }\n    }\n\n    render() {\n        if (this.state.redirect) {\n            return <Redirect to={this.state.redirect} />\n        } \n        return (\n            <div><Nav/>\n            <div class=\"container p-4\">\n                <script src=\"https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js\"></script>\n                <div class=\"row\">\n                    <div class=\"col-lg-9\">\n                        <div class=\"card\">\n                            <div class=\"card-body\">\n                                <div class=\"form-group \">\n                                    <input type=\"text\"\n                                        value={this.state.name}\n                                        onChange={(value) => this.setState({ name: value.target.value })}\n                                        class=\"form-control\" name=\"nombre\" placeholder=\"Nombre\" autofocus\n                                    />\n                                </div>\n\n                                <div class=\"row\">\n                                    <div class=\"col-lg-3\">\n                                        <div class=\"form-group\">\n                                            <select class=\"form-control\"\n                                                value={this.state.departmentId}\n                                                onChange={(value) => this.setState({ departmentId: value.target.value })} >\n                                                <option selected disabled>Departamento</option>\n                                                {this.state.departments}\n\n                                            </select>\n                                        </div>\n                                    </div>\n\n                                    <div class=\"col-lg-2\">\n                                        <div class=\"form-group\">\n                                            <select class=\"form-control\"\n                                                value={this.state.roleId}\n                                                onChange={(value) => this.setState({ roleId: value.target.value })} >\n                                                <option selected disabled >Rol</option>\n                                                {this.state.roles}\n                                            </select>\n                                        </div>\n                                    </div>\n\n                                    <div class=\"col-lg-3\">\n                                        <div class=\"form-group\">\n                                            <select class=\"form-control\"\n                                                value={this.state.tutorId}\n                                                onChange={(value) => this.setState({ tutorId: value.target.value })} >\n                                                <option selected disabled >Tutoría</option>\n                                                {this.state.tutors}\n                                            </select>\n                                        </div>\n                                    </div>\n\n                                </div>\n\n                                <div class=\"form-group\">\n                                    <textarea class=\"form-control\"\n                                        value={this.state.comment}\n                                        onChange={(value) => this.setState({ comment: value.target.value })}\n                                        placeholder=\"Introduzca si lo desea algún comentario: Me gusta J\"\n                                        rows=\"3\"></textarea>\n                                </div>\n\n                                <div class=\"form-group\">\n                                    <button type=\"submit\" class=\"btn btn-success\" onClick={() => this.updateProfessional()}>Actualizar</button>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class=\"col-lg-3\">\n                        <div class=\"card\">\n                            <div class=\"card-body text-center\">\n                                <form class=\"md-form\">\n                                    <div class=\"file-field\">\n                                        <div class=\"md-4\" >\n                                            <img src={require(\"../images/profile-picture.jpg\")}\n                                                ref={profilePicture => this.myProfilePicture = profilePicture}\n                                                id=\"blah\"\n                                                class=\"rounded-circle z-depth-1-half avatar-pic img-fluid img-thumbnail\" alt=\"avatar\"\n                                            />\n\n                                            <div style={{ marginTop: \"10px\" }} class=\"d-flex\" >\n                                                <div class=\"btn btn-mdb-color btn-rounded float-left custom-file\">\n                                                    <input style={{ width: \"100%\" }} ref={(myElement) => this.myFileElement = myElement}\n                                                        type=\"file\"\n                                                        id=\"imgInput\"\n                                                        className=\"custom-file-input btn btn-primary\"\n                                                        onChange={(value) => { this.readURL(value.target) }}\n                                                    />\n                                                    <label class=\"custom-file-label\" for=\"customFile\">Perfil</label>\n                                                </div>\n                                            </div>\n                                        </div>\n\n                                    </div>\n                                </form>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            </div>\n        );\n    }\n\n\n    readURL(input) {\n        if (input.files && input.files[0]) {\n            const myValue = input.files[0];\n\n            if (myValue.type.includes(\"image\")) {\n                const reader = new FileReader();\n                let miImagen = {\n                    name: myValue.name,\n                    type: myValue.type\n                }\n\n                reader.readAsDataURL(myValue); \n                reader.onload = async (event) => {\n                    miImagen.data = await event.target.result;\n                    this.state.image = miImagen;\n                    $('#blah').attr('src', this.state.image.data);\n                }\n                reader.onerror = (err) => {\n                    console.error('Error en lectura de imagen --> '+err);\n                }\n            } else {\n                Swal.fire({\n                    position: 'top',\n                    icon: 'error',\n                    title: 'Sólo archivos de tipo imagen!',\n                    showConfirmButton: false,\n                    timer: 2000\n                })\n            }\n        }\n    }\n\n    async cargarImagenDeBBDD(imagenDeBBDD) {\n        let buffer = await ProfileController.cargarImagenDeBBDD(imagenDeBBDD);\n        //console.log(buffer);\n        if (buffer) {\n            //Setear imagen en html\n            $('#blah').attr('src', buffer);\n            //actualizar el state\n            this.setState({ image: buffer});\n        }\n    }\n\n    validateFields() {\n        let emptyFields = \"\";\n        let count = 0;\n        const nombre = this.state.name;\n\n        if (nombre.replace(/\\s/g, \"\").length == 0) {\n            emptyFields += \" Nombre \";\n            count++;\n        }\n        if (this.state.departmentId == null) {\n            emptyFields += \" Departamento \";\n            count++;\n        }\n        if (this.state.roleId == null) {\n            emptyFields += \" Rol \";\n            count++;\n        }\n\n        //If there are errors\n        if (count > 0) {\n            Swal.fire({\n                position: 'center',\n                icon: 'error',\n                title: (count == 1 ? \"Falta el campo\" : \"Faltan los campos: \") + emptyFields,\n                showConfirmButton: false,\n                timer: 2000\n            })\n            return false;\n        } else {\n            return true;\n        }\n\n    }\n\n    updateProfessional() {\n        if (this.validateFields() == false) {\n            return;\n        }\n\n        // parametros de datos post\n        const datapost = {\n            id: this.state.id,\n            name: this.state.name,\n            departmentId: this.state.departmentId,\n            roleId: this.state.roleId,\n            email: this.state.email,\n            tutorId: this.state.tutorId,\n            comment: this.state.comment,\n            image: this.state.image,\n            imageId: this.state.imageId\n        }\n\n        ProfessionalService.update(datapost)\n            .then(res => {\n                if (res.data.success) {\n                    Swal.fire({\n                        position: 'top',\n                        icon: 'success',\n                        title: 'Profesional actualizado correctamente!',\n                        showConfirmButton: false,\n                        timer: 2000\n                    })\n                }\n                else {\n                    console.error(\"Error\");\n                }\n            }).catch(error => {\n                console.error(\"Error 34 \" + error);\n            });\n    }\n}\n\n\n\nexport default profileComponent;"]},"metadata":{},"sourceType":"module"}